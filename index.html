<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NANO PRO | Separa√ß√£o de Ordem</title>
    <meta name="description"
        content="Nano Pro - Sistema de Log√≠stica Industrial Inteligente para gest√£o de alta performance">
    <link rel="icon" type="image/png" href="favicon.png">

    <!-- Google Fonts - Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">

    <!-- SheetJS for Excel reading -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>

    <!-- Supabase Client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- Main Styles -->
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <img src="logo.png" alt="Nano Pro" class="logo-img">
            </div>
            <div class="header-info">
                <button id="btnToggleTheme" class="btn-icon" title="Alternar Tema Clare/Escuro">
                    <span id="themeIcon">üåô</span>
                </button>
                <span class="current-date" id="currentDate"></span>
                <span class="current-time" id="currentTime"></span>
                <div class="user-info" id="userInfo"></div>
            </div>
        </div>
    </header>

    <!-- Login Overlay -->
    <div class="login-overlay" id="loginOverlay">
        <div class="login-branding">
            <div class="login-logo-container">
                <img src="logo.png" alt="Nano Pro" class="login-logo-img">
            </div>
            <p class="login-subtitle">LOG√çSTICA INDUSTRIAL INTELIGENTE</p>
        </div>
        <div class="login-card">
            <form class="login-form" id="loginForm" onsubmit="return false;">
                <div class="form-group">
                    <label>
                        <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path>
                            <circle cx="12" cy="7" r="4"></circle>
                        </svg>
                        Login
                    </label>
                    <input type="text" id="loginUsername" placeholder="Seu login">
                </div>
                <div class="form-group">
                    <label>
                        <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect width="18" height="11" x="3" y="11" rx="2" ry="2"></rect>
                            <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                        </svg>
                        Senha
                    </label>
                    <input type="password" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <button type="submit" class="btn btn-primary btn-lg btn-block" id="btnLogin">
                    Entrar
                </button>
                <p class="guest-link-wrapper">
                    <button type="button" class="guest-link" onclick="Auth.loginAsGuest()">Modo Consulta
                        (Visitante)</button>
                </p>
            </form>
        </div>
        <div class="login-footer">
            <p>Nano Pro ¬© 2026 - Gest√£o Industrial de Alta Performance</p>
        </div>
    </div>

    <!-- Main Container -->
    <div class="app-container" id="appContainer">
        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <div class="sidebar-title">
                <span class="sidebar-icon">‚ò∞</span>
                <span>SEPARA√á√ÉO</span>
                <span>DE</span>
                <span>ORDEM DE PRODU√á√ÉO</span>
            </div>
            <ul class="nav-menu">
                <li class="nav-item active" data-tab="dashboard">
                    <span class="nav-icon">üè†</span>
                    <span class="nav-text">Dashboard</span>
                </li>
                <li class="nav-item" data-tab="enderecos">
                    <span class="nav-icon">üìç</span>
                    <span class="nav-text">Endere√ßos</span>
                </li>
                <li class="nav-item" data-tab="empenhos">
                    <span class="nav-icon">üì¶</span>
                    <span class="nav-text">Empenhos</span>
                </li>
                <li class="nav-item" data-tab="separacao">
                    <span class="nav-icon">‚úÖ</span>
                    <span class="nav-text">Separa√ß√£o</span>
                </li>
                <li class="nav-item" data-tab="conferencia">
                    <span class="nav-icon">üîç</span>
                    <span class="nav-text">Confer√™ncia</span>
                </li>
                <li class="nav-item" data-tab="matriz-filial">
                    <span class="nav-icon">üè¢</span>
                    <span class="nav-text">Matriz x Filial</span>
                </li>
                <li class="nav-item" data-tab="blacklist">
                    <span class="nav-icon">‚ùå</span>
                    <span class="nav-text">BlackList</span>
                </li>
                <li class="nav-item" data-tab="historico">
                    <span class="nav-icon">üìö</span>
                    <span class="nav-text">Hist√≥rico</span>
                </li>
                <li class="nav-item" data-tab="configuracoes" style="display: none;">
                    <span class="nav-icon">‚öôÔ∏è</span>
                    <span class="nav-text">Configura√ß√µes</span>
                </li>
            </ul>

        </nav>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Tab: Dashboard -->
            <section class="tab-content active" id="tab-dashboard">
                <div class="content-header">
                    <h1>Dashboard</h1>
                    <p>Vis√£o geral do sistema</p>
                </div>

                <!-- Time Filter -->
                <div class="dashboard-controls" style="margin-bottom: 2.5rem;">
                    <button id="btnShowInsights" class="btn btn-info" style="margin-right: 1rem;">
                        üìä Insights de Dados
                    </button>
                    <label for="dashboardPeriodo">Per√≠odo:</label>
                    <select id="dashboardPeriodo">
                        <option value="7">√öltimos 7 dias</option>
                        <option value="15">√öltimos 15 dias</option>
                        <option value="30">√öltimos 30 dias</option>
                        <option value="90">√öltimos 90 dias</option>
                    </select>
                </div>

                <div class="dashboard-grid">
                    <div class="dashboard-card warning">
                        <div class="dashboard-card-icon">‚ö†Ô∏è</div>
                        <div class="dashboard-card-content">
                            <span class="dashboard-card-value" id="dashPendentes">0</span>
                            <span class="dashboard-card-label">Pendentes</span>
                        </div>
                    </div>
                    <div class="dashboard-card success">
                        <div class="dashboard-card-icon">‚úÖ</div>
                        <div class="dashboard-card-content">
                            <span class="dashboard-card-value" id="dashFinalizadas">0</span>
                            <span class="dashboard-card-label">Finalizadas (per√≠odo)</span>
                        </div>
                    </div>
                    <div class="dashboard-card info">
                        <div class="dashboard-card-icon">üì¶</div>
                        <div class="dashboard-card-content">
                            <span class="dashboard-card-value" id="dashEmSeparacao">0</span>
                            <span class="dashboard-card-label">Em Separa√ß√£o</span>
                        </div>
                    </div>
                    <div class="dashboard-card primary">
                        <div class="dashboard-card-icon">üîç</div>
                        <div class="dashboard-card-content">
                            <span class="dashboard-card-value" id="dashEmConferencia">0</span>
                            <span class="dashboard-card-label">Em Confer√™ncia</span>
                        </div>
                    </div>
                </div>

                <!-- Armaz√©ns Distribution -->
                <div class="dashboard-section">
                    <h3>üè≠ Distribui√ß√£o por Armaz√©m</h3>
                    <div id="listaArmazens" class="armazem-grid">
                        <p class="empty-text">Nenhum dado dispon√≠vel</p>
                    </div>
                </div>

                <div class="dashboard-section">
                    <h3>‚ö†Ô∏è Pend√™ncias</h3>
                    <div id="listaPendencias" class="dashboard-cards-grid">
                        <p class="empty-text">Nenhuma pend√™ncia</p>
                    </div>
                </div>

                <div class="dashboard-section">
                    <h3>‚úÖ Finalizadas no Per√≠odo</h3>
                    <div id="listaFinalizadas" class="dashboard-cards-grid">
                        <p class="empty-text">Nenhuma ordem finalizada</p>
                    </div>
                </div>
            </section>

            <!-- Tab: Endere√ßos -->
            <section class="tab-content" id="tab-enderecos">
                <div class="content-header">
                    <h1>Endere√ßos de Estoque</h1>
                    <p>Localiza√ß√£o dos produtos no armaz√©m</p>
                </div>

                <div class="toolbar">
                    <div class="search-box">
                        <input type="text" id="searchEnderecos" placeholder="Buscar endere√ßo ou produto...">
                        <span class="search-icon">üîç</span>
                    </div>
                    <span class="item-counter" id="countEnderecos">0 itens</span>
                    <div class="toolbar-actions">
                        <button class="btn btn-outline" id="btnModeloEnderecos">
                            <span>üìÑ</span> Baixar Modelo Excel
                        </button>
                        <label class="btn btn-primary">
                            <span>üì•</span> Importar Excel
                            <input type="file" id="importEnderecos" accept=".xlsx,.xls" hidden>
                        </label>
                        <button class="btn btn-danger" id="btnLimparEnderecos">
                            <span>üóëÔ∏è</span> Limpar Tudo
                        </button>
                    </div>
                </div>

                <div class="table-container">
                    <table class="data-table" id="tableEnderecos">
                        <thead>
                            <tr>
                                <th>C√≥digo</th>
                                <th>Descri√ß√£o</th>
                                <th>Endere√ßo</th>
                                <th>Armaz√©m</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                    <div class="empty-state" id="emptyEnderecos">
                        <span class="empty-icon">üìç</span>
                        <p>Nenhum endere√ßo cadastrado</p>
                        <small>Importe um arquivo Excel para come√ßar</small>
                    </div>
                </div>
            </section>

            <!-- Tab: Empenhos -->
            <section class="tab-content" id="tab-empenhos">
                <div class="content-header">
                    <h1>Empenhos - Ordens de Produ√ß√£o</h1>
                    <p>Importe e selecione as OPs para gerar lista de separa√ß√£o</p>
                </div>

                <!-- Sele√ß√£o de OPs -->
                <div class="selection-panel">
                    <div class="selection-header">
                        <label>SELECIONE AS ORDENS DE PRODU√á√ÉO</label>
                        <div class="toolbar-actions">
                            <button class="btn btn-outline" id="btnModeloEmpenhos">
                                <span>üìÑ</span> Baixar Modelo Excel
                            </button>
                            <label class="btn btn-primary">
                                <span>üì•</span> Importar Ordens (Excel)
                                <input type="file" id="importEmpenhos" accept=".xlsx,.xls" hidden>
                            </label>
                            <button class="btn btn-success" id="btnGerarSeparacao">
                                <span>‚úÖ</span> Gerar Lista de Separa√ß√£o
                            </button>
                            <button class="btn btn-danger" id="btnLimparEmpenhos">
                                <span>üóëÔ∏è</span> Limpar Tudo
                            </button>
                        </div>
                    </div>
                    <div class="op-selector" id="opSelector">
                        <span class="empty-text">Importe ordens para selecionar</span>
                    </div>
                </div>

                <!-- Armaz√©m destino -->
                <div class="info-panel compact">
                    <div class="info-field">
                        <label>Armaz√©m (Destino)</label>
                        <select id="armazemDestino">
                            <option value="">Selecione...</option>
                            <option value="CHICOTE">CHICOTE</option>
                            <option value="MECANICA">MEC√ÇNICA</option>
                            <option value="ELETRONICA">ELETR√îNICA</option>
                        </select>
                    </div>
                </div>

                <!-- Lista de OPs Pendentes (selecionadas) -->
                <div class="orders-section">
                    <h3>üìã ORDEM DE PRODU√á√ÉO</h3>
                    <div class="table-container">
                        <table class="data-table" id="tableOPsPendentes">
                            <thead>
                                <tr>
                                    <th>Ordem de Produ√ß√£o</th>
                                    <th>Data</th>
                                    <th>Qtd Itens</th>
                                    <th>Status</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                        <div class="empty-state show" id="emptyOPsPendentes">
                            <span class="empty-icon">üì¶</span>
                            <p>Nenhuma ordem selecionada</p>
                            <small>Clique em uma OP acima para adicion√°-la como pendente</small>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Tab: BlackList -->
            <section class="tab-content" id="tab-blacklist">
                <div class="content-header">
                    <h1>BlackList</h1>
                    <p>Itens que n√£o necessitam separa√ß√£o (aparecem em vermelho)</p>
                </div>

                <div class="toolbar"
                    style="display: flex; align-items: center; gap: 10px; flex-wrap: wrap; background: white; padding: 15px; border-radius: 12px; border: 1px solid var(--gray-200); margin-bottom: 20px;">
                    <div class="add-blacklist-form"
                        style="display: flex; gap: 8px; flex-wrap: wrap; align-items: center;">
                        <input type="text" id="blacklistCode" placeholder="C√≥digo" style="width: 120px;">
                        <input type="text" id="blacklistDesc" placeholder="Descri√ß√£o" style="width: 200px;">
                        <button class="btn btn-danger" id="btnAddBlacklist">
                            <span>‚ûï</span> Adicionar
                        </button>
                    </div>

                    <div style="height: 24px; width: 1px; background: var(--gray-200); margin: 0 5px;"></div>

                    <div class="toolbar-actions" style="display: flex; align-items: center; gap: 8px; flex-wrap: wrap;">
                        <button class="btn btn-outline" id="btnModeloBlacklist" style="padding: 8px 12px;">
                            <span>üìÑ</span> Baixar Modelo
                        </button>
                        <label class="btn btn-primary" style="padding: 8px 12px; margin: 0;">
                            <span>üì•</span> Importar Excel
                            <input type="file" id="importBlacklist" accept=".xlsx,.xls" hidden>
                        </label>
                        <button class="btn btn-danger btn-outline" id="btnLimparBlacklist" style="padding: 8px 12px;">
                            <span>üóëÔ∏è</span> Limpar Tudo
                        </button>
                    </div>

                    <div class="search-box"
                        style="flex: 1; min-width: 250px; display: flex; align-items: center; background: var(--gray-100); padding: 8px 12px; border-radius: 8px; border: 1px solid var(--gray-200); margin-left: auto;">
                        <span style="margin-right: 8px;">üîç</span>
                        <input type="text" id="blacklistSearch" placeholder="Pesquisar..."
                            style="border: none; outline: none; background: transparent; width: 100%; font-size: 0.95rem;">
                    </div>
                </div>

                <div class="table-container">
                    <table class="data-table" id="tableBlacklist">
                        <thead>
                            <tr>
                                <th>C√≥digo</th>
                                <th>Descri√ß√£o</th>
                                <th class="center" style="width: 100px;">
                                    <div style="display: flex; flex-direction: column; align-items: center; gap: 4px;">
                                        <span style="font-size: 0.75rem;">N√£o Sep</span>
                                        <input type="checkbox" id="selectAllNaoSep" title="Selecionar Todos">
                                    </div>
                                </th>
                                <th class="center" style="width: 100px;">
                                    <div style="display: flex; flex-direction: column; align-items: center; gap: 4px;">
                                        <span style="font-size: 0.75rem;">Talvez</span>
                                        <input type="checkbox" id="selectAllTalvez" title="Selecionar Todos">
                                    </div>
                                </th>
                                <th>Data Inclus√£o</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                    <div class="empty-state" id="emptyBlacklist">
                        <span class="empty-icon">‚ùå</span>
                        <p>Nenhum item na BlackList</p>
                        <small>Adicione itens que n√£o precisam ser separados</small>
                    </div>
                </div>
            </section>

            <!-- Tab: Separa√ß√£o -->
            <section class="tab-content" id="tab-separacao">
                <!-- View: Lista de Listas -->
                <div id="separacaoListView">
                    <div class="content-header">
                        <h1>Separa√ß√£o</h1>
                        <p>Selecione uma lista para iniciar a separa√ß√£o</p>
                    </div>

                    <div class="cards-container" id="separacaoListas">
                    </div>
                    <div class="empty-state show" id="emptySeparacaoListas">
                        <span class="empty-icon">‚úÖ</span>
                        <p>Nenhuma lista de separa√ß√£o</p>
                        <small>Gere uma lista em "Empenhos" para come√ßar</small>
                    </div>
                </div>

                <!-- View: Detalhes da Lista -->
                <div id="separacaoDetailView" style="display: none;">
                    <div class="content-header">
                        <button class="btn btn-outline" id="btnVoltarSeparacao">
                            <span>‚Üê</span> Voltar
                        </button>
                        <h1 id="separacaoListaTitulo">Lista de Separa√ß√£o</h1>
                        <p id="separacaoListaInfo"></p>
                    </div>

                    <div class="info-panel">
                        <div class="info-row">
                            <div class="info-field">
                                <label>Documento (Transfer√™ncia)</label>
                                <input type="text" id="docTransferencia" placeholder="N¬∫ do documento">
                            </div>
                            <div class="info-field">
                                <label>Respons√°vel (Separa√ß√£o)</label>
                                <input type="text" id="responsavelSeparacao" placeholder="Nome do respons√°vel">
                            </div>
                        </div>
                    </div>

                    <div class="stats-bar">
                        <div class="stat-item">
                            <span class="stat-value" id="totalSeparar">0</span>
                            <span class="stat-label">Total de Itens</span>
                        </div>
                        <div class="stat-item success">
                            <span class="stat-value" id="totalSeparados">0</span>
                            <span class="stat-label">Separados</span>
                        </div>
                        <div class="stat-item info">
                            <span class="stat-value" id="totalTransferidos">0</span>
                            <span class="stat-label">Transferidos</span>
                        </div>
                        <div class="stat-item warning">
                            <span class="stat-value" id="totalNaoSeparados">0</span>
                            <span class="stat-label">N√£o Separados</span>
                        </div>
                    </div>

                    <div class="toolbar">
                        <div class="search-box">
                            <input type="text" id="searchSeparacao" placeholder="Buscar item...">
                            <span class="search-icon">üîç</span>
                        </div>
                        <div class="toolbar-actions">
                            <button class="btn btn-warning" id="btnSalvarPendenteSeparacao"
                                style="margin-right: 0.5rem;">
                                <span>‚è∏Ô∏è</span> Salvar com Pend√™ncias
                            </button>
                            <button class="btn btn-success" id="btnEnviarConferencia">
                                <span>üì§</span> Enviar para Confer√™ncia
                            </button>
                        </div>
                    </div>

                    <div class="table-container">
                        <table class="data-table separacao-table" id="tableSeparacao">
                            <thead>
                                <tr>
                                    <th>C√≥digo</th>
                                    <th>Descri√ß√£o</th>
                                    <th class="center">Qtd Solicitada</th>
                                    <th class="center">Qtd Separada</th>
                                    <th class="center">Separado</th>
                                    <th class="center">Transferido</th>
                                    <th class="center">N√£o Sep.</th>
                                    <th>Observa√ß√£o</th>
                                </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                        <div class="empty-state" id="emptySeparacao">
                            <span class="empty-icon">‚úÖ</span>
                            <p>Nenhum item para separar</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Tab: Confer√™ncia -->
            <section class="tab-content" id="tab-conferencia">
                <!-- View: Lista de Confer√™ncias -->
                <div id="conferenciaListView">
                    <div class="content-header">
                        <h1>Confer√™ncia</h1>
                        <p>Selecione uma lista para conferir</p>
                    </div>

                    <div class="cards-container" id="conferenciaListas">
                    </div>
                    <div class="empty-state show" id="emptyConferenciaListas">
                        <span class="empty-icon">üîç</span>
                        <p>Nenhuma confer√™ncia pendente</p>
                        <small>Envie uma separa√ß√£o para confer√™ncia</small>
                    </div>
                </div>

                <!-- View: Detalhes da Confer√™ncia -->
                <div id="conferenciaDetailView" style="display: none;">
                    <div class="content-header">
                        <div style="display: flex; gap: 0.5rem; align-items: center;">
                            <button class="btn btn-outline" id="btnVoltarConferencia">
                                <span>‚Üê</span> Voltar
                            </button>
                            <button class="btn btn-warning" id="btnReverterSituacao" style="display: none;">
                                <span>üîÑ</span> Voltar Situa√ß√£o
                            </button>
                        </div>
                        <h1 id="conferenciaListaTitulo">Confer√™ncia</h1>
                        <p id="conferenciaListaInfo"></p>
                    </div>

                    <!-- Filtro por OP -->
                    <div class="info-panel">
                        <div class="info-row">
                            <div class="info-field">
                                <label>Filtrar por Ordem de Produ√ß√£o</label>
                                <select id="filtroOPConferencia">
                                    <option value="">Todas as OPs</option>
                                </select>
                            </div>
                            <div class="info-field">
                                <label>Respons√°vel (Confer√™ncia)</label>
                                <input type="text" id="responsavelConferencia" placeholder="Nome de quem conferiu">
                            </div>
                            <div class="info-field readonly">
                                <label>Data da Confer√™ncia</label>
                                <input type="text" id="dataConferencia" readonly>
                                <span class="field-note">‚ö†Ô∏è Data autom√°tica</span>
                            </div>
                        </div>
                    </div>

                    <!-- Ordens e progresso -->
                    <div class="orders-panel">
                        <h3>üìã Ordens de Produ√ß√£o - Status</h3>
                        <div class="orders-list" id="ordensConferencia">
                            <span class="empty-orders">Nenhuma ordem</span>
                        </div>
                    </div>

                    <div class="stats-bar">
                        <div class="stat-item">
                            <span class="stat-value" id="totalConferir">0</span>
                            <span class="stat-label">Total de Itens</span>
                        </div>
                        <div class="stat-item success">
                            <span class="stat-value" id="totalConferidos">0</span>
                            <span class="stat-label">Conferidos OK</span>
                        </div>
                        <div class="stat-item warning">
                            <span class="stat-value" id="totalPendentes">0</span>
                            <span class="stat-label">Pendentes</span>
                        </div>
                        <div class="stat-item danger">
                            <span class="stat-value" id="totalFaltando">0</span>
                            <span class="stat-label">Com Falta</span>
                        </div>
                    </div>

                    <div class="table-container">
                        <table class="data-table conferencia-table" id="tableConferencia">
                            <thead>
                                <tr>
                                    <th>C√≥digo</th>
                                    <th>Descri√ß√£o</th>
                                    <th class="center">Qtd Solicitada</th>
                                    <th class="center">Qtd Separada</th>
                                    <th class="center">OK</th>
                                    <th class="center">FALTA</th>
                                    <th>Observa√ß√£o</th>
                                </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                        <div class="empty-state" id="emptyConferencia">
                            <span class="empty-icon">üîç</span>
                            <p>Nenhum item para conferir</p>
                        </div>
                    </div>

                    <div class="action-bar">
                        <button class="btn btn-warning btn-lg" id="btnSalvarPendente">
                            <span>‚è∏Ô∏è</span> Salvar com Pend√™ncias
                        </button>
                        <button class="btn btn-info btn-lg" id="btnListaTransferencia">
                            <span id="iconTransferencia">üìã</span> Lista de Transfer√™ncia
                        </button>
                        <button class="btn btn-success btn-lg" id="btnFinalizarConferencia" disabled>
                            <span>‚úîÔ∏è</span> Finalizar Confer√™ncia
                        </button>
                    </div>
                </div>
            </section>

            <!-- Tab: Hist√≥rico -->
            <section class="tab-content" id="tab-historico">
                <div class="content-header">
                    <h1>Hist√≥rico</h1>
                    <p>Ordens de produ√ß√£o finalizadas</p>
                </div>

                <div class="toolbar">
                    <div class="search-box">
                        <input type="text" id="searchHistorico" placeholder="Buscar ordem...">
                        <span class="search-icon">üîç</span>
                    </div>

                    <div style="display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
                        <div class="info-field" style="margin: 0; min-width: 150px;">
                            <label style="font-size: 0.75rem;">Armaz√©m</label>
                            <select id="filtroArmazemHistorico" style="height: 38px; padding: 0 10px;">
                                <option value="">Todos</option>
                                <option value="MATRIZ">MATRIZ</option>
                                <option value="FILIAL">FILIAL</option>
                                <option value="EXTERNO">EXTERNO</option>
                            </select>
                        </div>
                        <div class="info-field" style="margin: 0;">
                            <label style="font-size: 0.75rem;">In√≠cio</label>
                            <input type="date" id="filtroDataInicioHistorico" style="height: 38px;">
                        </div>
                        <div class="info-field" style="margin: 0;">
                            <label style="font-size: 0.75rem;">Fim</label>
                            <input type="date" id="filtroDataFimHistorico" style="height: 38px;">
                        </div>
                    </div>

                    <div class="toolbar-actions">
                        <button class="btn btn-outline" id="btnExportarHistorico">
                            <span>üì§</span> Exportar Hist√≥rico
                        </button>
                    </div>
                </div>

                <div class="cards-container" id="historicoListas">
                </div>
                <div class="empty-state show" id="emptyHistorico">
                    <span class="empty-icon">üìö</span>
                    <p>Nenhuma ordem finalizada</p>
                    <small>As ordens finalizadas aparecer√£o aqui</small>
                </div>
            </section>

            <!-- Tab: Configura√ß√µes -->
            <section class="tab-content" id="tab-configuracoes">
                <div class="content-header">
                    <h1>Configura√ß√µes</h1>
                    <p>Gerenciamento de usu√°rios do sistema</p>
                </div>

                <div class="toolbar">
                    <div class="toolbar-actions">
                        <button class="btn btn-success" id="btnAddUser">
                            <span>‚ûï</span> Novo Usu√°rio
                        </button>
                        <button class="btn btn-outline" id="btnExportDataTab">
                            <span>üì§</span> Exportar Dados
                        </button>
                        <label class="btn btn-outline" style="cursor: pointer;">
                            <span>üì•</span> Importar Dados
                            <input type="file" id="importJsonData" accept=".json" hidden>
                        </label>
                        <button class="btn btn-primary" id="btnBackup">
                            <button class="btn btn-warning" id="btnRestoreBackup">
                                <span>üîÑ</span> Restaurar Backup
                            </button>
                            <button class="btn btn-warning" id="btnLogoutTodos"
                                title="Limpar todas as travas de usu√°rios nos cards">
                                <span>üö™</span> Deslogar Todos
                            </button>
                            <button class="btn btn-danger" id="btnResetData">
                                <span>üóëÔ∏è</span> Resetar Dados
                            </button>
                    </div>
                </div>

                <div class="table-container">
                    <table class="data-table" id="tableUsers">
                        <thead>
                            <tr>
                                <th>Usu√°rio</th>
                                <th>Nome</th>
                                <th>Tipo</th>
                                <th>Permiss√µes</th>
                                <th>Criado em</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody">
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Tab: Matriz x Filial -->
            <section class="tab-content" id="tab-matriz-filial">
                <div class="content-header">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; width: 100%; flex-wrap: wrap; gap: 1rem;">
                        <div>
                            <h1>Matriz x Filial</h1>
                            <p>Controle de produtos acabados para a Filial</p>
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px; flex: 1; max-width: 600px;">
                            <button class="btn btn-outline btn-sm" onclick="MatrizFilial.showHistorico()"
                                style="padding: 8px 12px; height: 38px; display: flex; align-items: center; gap: 5px; white-space: nowrap;">
                                <span>üìö</span> Hist√≥rico Completo
                            </button>
                            <select id="matrizFilialStatusFilter"
                                style="padding: 8px 12px; border-radius: 8px; border: 1px solid var(--gray-200); background: white; font-size: 0.9rem; min-width: 150px; height: 38px;">
                                <option value="all">Todos os Status</option>
                                <option value="separacao">üì¶ Em Separa√ß√£o</option>
                                <option value="conferencia">üîç Em Confer√™ncia</option>
                                <option value="qualidade">üî¨ Em Qualidade</option>
                                <option value="enderecar">üìç Endere√ßar</option>
                                <option value="transito">üöö Em Tr√¢nsito</option>
                                <option value="recebido">‚úÖ Recebido</option>
                            </select>
                            <div class="search-box"
                                style="flex: 1; display: flex; align-items: center; background: var(--gray-100); padding: 8px 12px; border-radius: 8px; border: 1px solid var(--gray-200); height: 38px;">
                                <span style="margin-right: 8px;">üîç</span>
                                <input type="text" id="matrizFilialSearch" placeholder="Pesquisar..."
                                    style="border: none; outline: none; background: transparent; width: 100%; font-size: 0.95rem;">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="pa-container">
                    <div id="matrizFilialCards" class="pa-cards-grid">
                        <p class="empty-text">Carregando...</p>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Modal -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">T√≠tulo</h2>
                <button class="modal-close" id="modalClose">&times;</button>
            </div>
            <div class="modal-body" id="modalBody">
            </div>
            <div class="modal-footer" id="modalFooter">
            </div>
        </div>
    </div>

    <!-- Urgency Modal -->
    <div class="urgency-modal" id="urgencyModal">
        <div class="urgency-modal-content">
            <div class="urgency-header">
                <span class="urgency-icon">üö®</span>
                <h2>ALERTA DE URG√äNCIA</h2>
            </div>
            <div class="urgency-body" id="urgencyBody">
                <!-- Dynamic content -->
            </div>
            <div class="urgency-footer">
                <button class="btn btn-danger" onclick="App.closeUrgencyModal()">
                    Entendi - Fechar Alerta
                </button>
            </div>
        </div>
    </div>

    <!-- Alert Sound (generated programmatically) -->
    <audio id="alertSound" preload="auto">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAAC..."
            type="audio/wav">
    </audio>

    <!-- Scripts -->
    <script src="modules/storage.js"></script>
    <script src="modules/supabase.js"></script>
    <script src="modules/excel.js"></script>
    <script src="modules/auth.js"></script>
    <script src="modules/dashboard.js"></script>
    <script src="modules/cadastro.js"></script>
    <script src="modules/enderecos.js"></script>
    <script src="modules/empenhos.js"></script>
    <script src="modules/blacklist.js"></script>
    <script src="modules/separacao.js"></script>
    <script src="modules/conferencia.js"></script>
    <script src="modules/historico.js"></script>
    <script src="modules/auditoria.js"></script>
    <script src="modules/matriz_filial.js"></script>
    <script src="modules/configuracoes.js"></script>
    <script src="app.js"></script>
</body>

</html>